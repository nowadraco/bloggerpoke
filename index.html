<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokédex</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
        }
        .pokedex {
            background-color: #e53e3e; /* Vermelho Pokédex */
            border-radius: 20px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2), 0 6px 6px rgba(0,0,0,0.23);
            border: 10px solid #d1d5db;
        }
        .pokedex-screen {
            background-color: #1a202c; /* Tela escura */
            border: 4px solid #4a5568;
        }
        .pokemon-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            cursor: pointer;
        }
        .pokemon-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .type-badge {
            display: inline-block;
            padding: 0.25em 0.6em;
            font-size: 0.75em;
            font-weight: 700;
            line-height: 1;
            text-align: center;
            white-space: nowrap;
            vertical-align: baseline;
            border-radius: 0.375rem;
            color: #fff;
        }
        /* Cores dos tipos de Pokémon */
        .normal { background-color: #A8A77A; }
        .fire { background-color: #EE8130; }
        .water { background-color: #6390F0; }
        .electric { background-color: #F7D02C; }
        .grass { background-color: #7AC74C; }
        .ice { background-color: #96D9D6; }
        .fighting { background-color: #C22E28; }
        .poison { background-color: #A33EA1; }
        .ground { background-color: #E2BF65; }
        .flying { background-color: #A98FF3; }
        .psychic { background-color: #F95587; }
        .bug { background-color: #A6B91A; }
        .rock { background-color: #B6A136; }
        .ghost { background-color: #735797; }
        .dragon { background-color: #6F35FC; }
        .dark { background-color: #705746; }
        .steel { background-color: #B7B7CE; }
        .fairy { background-color: #D685AD; }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="pokedex w-full max-w-4xl p-4 md:p-6">
        <!-- Cabeçalho da Pokédex -->
        <div class="flex items-center justify-between mb-6">
            <div class="flex items-center space-x-4">
                <div class="w-16 h-16 bg-blue-400 rounded-full border-4 border-white flex items-center justify-center">
                     <div class="w-12 h-12 bg-blue-500 rounded-full"></div>
                </div>
                <div class="flex space-x-2">
                    <div class="w-6 h-6 bg-red-500 rounded-full border-2 border-white"></div>
                    <div class="w-6 h-6 bg-yellow-400 rounded-full border-2 border-white"></div>
                    <div class="w-6 h-6 bg-green-500 rounded-full border-2 border-white"></div>
                </div>
            </div>
             <h1 class="text-3xl md:text-4xl font-bold text-white text-center flex-grow">Pokédex</h1>
        </div>

        <!-- Tela da Pokédex -->
        <div class="pokedex-screen p-4 rounded-lg mb-6">
            <div class="bg-gray-800 p-4 rounded">
                <input type="text" id="searchInput" class="w-full p-2 rounded bg-gray-700 text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Pesquisar Pokémon...">
            </div>
            <div id="pokedex-display" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 mt-4 h-96 overflow-y-auto pr-2">
                <!-- Cards de Pokémon serão inseridos aqui -->
            </div>
        </div>
    </div>

    <!-- Modal para detalhes do Pokémon -->
    <div id="pokemonModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center hidden z-50">
        <div class="bg-gray-800 text-white rounded-lg p-8 max-w-md w-full m-4 relative overflow-y-auto max-h-full">
            <button id="closeModal" class="absolute top-4 right-4 text-white text-2xl">&times;</button>
            <div id="modalContent" class="text-center">
                <!-- Detalhes do Pokémon serão inseridos aqui -->
            </div>
        </div>
    </div>

    <script>
        const searchInput = document.getElementById('searchInput');
        const pokedexDisplay = document.getElementById('pokedex-display');
        const pokemonModal = document.getElementById('pokemonModal');
        const closeModal = document.getElementById('closeModal');
        const modalContent = document.getElementById('modalContent');

        let pokemonData = [];

        // Array de multiplicadores de CP (CPM)
        const cpms = [0.0939999967813491, 0.135137430784308, 0.166397869586944, 0.192650914456886, 0.215732470154762, 0.236572655026622, 0.255720049142837, 0.273530381100769, 0.290249884128570, 0.306057381335773, 0.321087598800659, 0.335445032295077, 0.349212676286697, 0.362457748778790, 0.375235587358474, 0.387592411085168, 0.399567276239395, 0.411193549517250, 0.422500014305114, 0.432926413410414, 0.443107545375824, 0.453059953871985, 0.462798386812210, 0.472336077786704, 0.481684952974319, 0.490855810259008, 0.499858438968658, 0.508701756943992, 0.517393946647644, 0.525942508771329, 0.534354329109191, 0.542635762230353, 0.550792694091796, 0.558830599438087, 0.566754519939422, 0.574569148039264, 0.582278907299041, 0.589887911977272, 0.597400009632110, 0.604823657502073, 0.612157285213470, 0.619404110566050, 0.626567125320434, 0.633649181622743, 0.640652954578399, 0.647580963301656, 0.654435634613037, 0.661219263506722, 0.667934000492096, 0.674581899290818, 0.681164920330047, 0.687684905887771, 0.694143652915954, 0.700542893277978, 0.706884205341339, 0.713169102333341, 0.719399094581604, 0.725575616972598, 0.731700003147125, 0.734741011137376, 0.737769484519958, 0.740785574597326, 0.743789434432983, 0.746781208702482, 0.749761044979095, 0.752729105305821, 0.755685508251190, 0.758630366519684, 0.761563837528228, 0.764486065255226, 0.767397165298461, 0.770297273971590, 0.773186504840850, 0.776064945942412, 0.778932750225067, 0.781790064808426, 0.784636974334716, 0.787473583646825, 0.790300011634826, 0.792803950958807, 0.795300006866455, 0.797803921486970, 0.800300002098083, 0.802803892322847, 0.805299997329711, 0.807803863460723, 0.810299992561340, 0.812803834895026, 0.815299987792968, 0.817803806620319, 0.820299983024597, 0.822803778631297, 0.825299978256225, 0.827803750922782, 0.830299973487854, 0.832803753381377, 0.835300028324127, 0.837803755931569, 0.840300023555755, 0.842803729034748, 0.845300018787384, 0.847803702398935, 0.850300014019012, 0.852803676019539, 0.855300009250640, 0.857803649892077, 0.860300004482269, 0.862803624012168, 0.865299999713897];

        // Função para calcular o CP
        function calculateCP(baseStats, ivs, level) {
            const cpmIndex = Math.round((level - 1) * 2);
            const cpm = cpms[cpmIndex];
            const attack = baseStats.atk + ivs.atk;
            const defense = baseStats.def + ivs.def;
            const stamina = baseStats.hp + ivs.hp;
            const cp = Math.floor((attack * Math.sqrt(defense) * Math.sqrt(stamina) * cpm ** 2) / 10);
            return cp > 10 ? cp : 10; // CP mínimo é 10
        }

        // Carrega os dados do Pokémon do arquivo JSON
        async function fetchPokemonData() {
            try {
                const response = await fetch('https://raw.githubusercontent.com/nowadraco/bloggerpoke/c4ddc611f37ea9b4857f1dfd884e066a4684fc57/src/data/gamemaster.min.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                pokemonData = data.pokemon.filter(p => p.speciesName); // Filtra entradas sem nome
                displayPokemon(pokemonData);
            } catch (error) {
                console.error("Erro ao carregar dados dos Pokémon:", error);
                pokedexDisplay.innerHTML = `<p class="text-white col-span-full text-center">Não foi possível carregar os dados da Pokédex.</p>`;
            }
        }

        // Exibe os Pokémon na tela
        function displayPokemon(pokemonList) {
            pokedexDisplay.innerHTML = '';
            if (pokemonList.length === 0) {
                pokedexDisplay.innerHTML = `<p class="text-white col-span-full text-center">Nenhum Pokémon encontrado.</p>`;
                return;
            }
            pokemonList.forEach(pokemon => {
                const imageUrl = `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/${pokemon.dex}.png`;

                const card = document.createElement('div');
                card.className = 'pokemon-card bg-gray-700 rounded-lg p-4 flex flex-col items-center justify-center text-center';
                card.addEventListener('click', () => showPokemonDetails(pokemon));

                card.innerHTML = `
                    <img src="${imageUrl}" alt="${pokemon.speciesName}" class="w-20 h-20 object-contain mb-2" onerror="this.onerror=null;this.src='https://placehold.co/96x96/e53e3e/ffffff?text=?';">
                    <p class="text-white font-semibold text-sm capitalize">${pokemon.speciesName}</p>
                `;
                pokedexDisplay.appendChild(card);
            });
        }

        // Mostra os detalhes de um Pokémon em um modal
        function showPokemonDetails(pokemon) {
            const imageUrl = `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/${pokemon.dex}.png`;
            const typesHtml = pokemon.types.map(type => `<span class="type-badge ${type.toLowerCase()}">${type}</span>`).join(' ');

            // Calcula o CP para diferentes níveis com IVs perfeitos
            const perfectIVs = { atk: 15, def: 15, hp: 15 };
            const cpLv15 = calculateCP(pokemon.baseStats, perfectIVs, 15);
            const cpLv20 = calculateCP(pokemon.baseStats, perfectIVs, 20);
            const cpLv40 = calculateCP(pokemon.baseStats, perfectIVs, 40);
            const cpLv50 = calculateCP(pokemon.baseStats, perfectIVs, 50);

            modalContent.innerHTML = `
                <img src="${imageUrl}" alt="${pokemon.speciesName}" class="w-48 h-48 mx-auto mb-4" onerror="this.onerror=null;this.src='https://placehold.co/192x192/e53e3e/ffffff?text=?';">
                <h2 class="text-3xl font-bold capitalize mb-2">${pokemon.speciesName} (#${pokemon.dex})</h2>
                <div class="flex justify-center gap-2 mb-4">
                    ${typesHtml}
                </div>
                <div class="text-left grid grid-cols-2 gap-x-4 gap-y-2 mb-4">
                    <p><strong>Ataque:</strong> ${pokemon.baseStats.atk}</p>
                    <p><strong>Defesa:</strong> ${pokemon.baseStats.def}</p>
                    <p><strong>Stamina:</strong> ${pokemon.baseStats.hp}</p>
                </div>

                <div class="text-left bg-gray-700 p-3 rounded-lg mb-4">
                    <h3 class="font-bold text-lg mb-2 text-center">CP Máximo (100% IV)</h3>
                    <div class="grid grid-cols-2 gap-x-4 gap-y-1 text-sm">
                        <p><strong>Nível 15:</strong> ${cpLv15}</p>
                        <p><strong>Nível 20:</strong> ${cpLv20}</p>
                        <p><strong>Nível 40:</strong> ${cpLv40}</p>
                        <p><strong>Nível 50:</strong> ${cpLv50}</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-left">
                    <div>
                        <h3 class="font-bold text-lg mb-2">Ataques Rápidos</h3>
                        <ul class="list-disc list-inside text-sm">
                            ${pokemon.fastMoves.map(move => `<li class="capitalize">${move.replace(/_/g, ' ').toLowerCase()}</li>`).join('')}
                        </ul>
                    </div>
                     <div>
                        <h3 class="font-bold text-lg mb-2">Ataques Carregados</h3>
                        <ul class="list-disc list-inside text-sm">
                            ${pokemon.chargedMoves.map(move => `<li class="capitalize">${move.replace(/_/g, ' ').toLowerCase()}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            `;
            pokemonModal.classList.remove('hidden');
        }

        // Filtra os Pokémon com base na entrada de pesquisa
        searchInput.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const filteredPokemon = pokemonData.filter(pokemon =>
                pokemon.speciesName.toLowerCase().includes(searchTerm)
            );
            displayPokemon(filteredPokemon);
        });

        // Fecha o modal
        closeModal.addEventListener('click', () => {
            pokemonModal.classList.add('hidden');
        });

        // Fecha o modal ao clicar fora dele
        pokemonModal.addEventListener('click', (e) => {
            if (e.target === pokemonModal) {
                pokemonModal.classList.add('hidden');
            }
        });

        // Carrega os dados iniciais
        fetchPokemonData();
    </script>
</body>
</html>
